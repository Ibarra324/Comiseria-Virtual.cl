<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Carabineros | Chile Centro RolePlay</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles.css">
    <style>
        /* Estilos adicionales específicos para esta página */
        body {
            background-color: #e9ecef;
        }

        .admin-container {
            max-width: 960px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .admin-header {
            text-align: center;
            color: #28a745;
            margin-bottom: 20px;
        }

        .admin-user-info {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-bottom: 20px;
        }

        .admin-user-profile {
            display: flex;
            align-items: center;
        }

        .admin-user-profile img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-left: 10px;
        }

        .admin-user-profile span {
            font-weight: bold;
            margin-left: 10px;
        }

        .admin-message {
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .admin-access-denied {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .admin-list {
            list-style: none;
            padding: 0;
        }

        .admin-list-item {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .admin-list-item strong {
            font-weight: bold;
            color: #007bff;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-user-info">
            <div id="adminUserProfile" class="admin-user-profile hidden">
                <span>Bienvenido,</span>
                <span id="adminUserName"></span>
                <img id="adminUserAvatar" src="" alt="Avatar de Carabinero">
            </div>
        </div>
        <h1 class="admin-header">Panel de Carabineros</h1>

        <div id="accessDenied" class="admin-message admin-access-denied" style="display:none;">
            <strong>Acceso Denegado:</strong> No tienes los permisos necesarios para acceder a este panel. Serás redirigido en breve.
        </div>

        <div id="adminContent" style="display:none;">
            <p class="admin-message">Aquí podrás ver y gestionar los trámites enviados por los ciudadanos.</p>
            <h2>Trámites Recientes</h2>
            <ul class="admin-list" id="tramiteList">
                </ul>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const accessDeniedDiv = document.getElementById('accessDenied');
            const adminContentDiv = document.getElementById('adminContent');
            const tramiteList = document.getElementById('tramiteList');
            const adminUserProfileDiv = document.getElementById('adminUserProfile');
            const adminUserAvatarImg = document.getElementById('adminUserAvatar');
            const adminUserNameSpan = document.getElementById('adminUserName');
            const storedAuthTokenAdmin = localStorage.getItem('authToken'); // Ejemplo básico

            if (storedAuthTokenAdmin) {
                // ** Aquí deberías hacer una petición al backend para verificar el rol del usuario
                // basado en el authToken y obtener los datos del usuario y los trámites. **
                // Esto es solo una simulación:
                const mockAdminUser = { roles: ['carabinero'], username: 'AdminUsuario', avatarUrl: 'https://via.placeholder.com/40/0000FF/FFFFFF?Text=CA' };
                if (mockAdminUser.roles && mockAdminUser.roles.includes('carabinero')) {
                    adminContentDiv.style.display = 'block';
                    adminUserProfileDiv.classList.remove('hidden');
                    adminUserAvatarImg.src = mockAdminUser.avatarUrl;
                    adminUserNameSpan.textContent = mockAdminUser.username;

                    // Simulación de datos de trámites
                    const tramitesSimulados = [
                        { tipo: 'Hurto Simple', usuario: 'Ciudadano123' },
                        { tipo: 'Robo de Vehiculo', usuario: 'Usuario456' },
                        { tipo: 'Estafa', usuario: 'OtroUsuario' },
                        { tipo: 'Reclamo', usuario: 'Quejoso789' }
                        // Agrega más trámites simulados aquí
                    ];
                    tramitesSimulados.forEach(tramite => {
                        const listItem = document.createElement('li');
                        listItem.classList.add('admin-list-item');
                        listItem.innerHTML = `<strong>Tipo:</strong> ${tramite.tipo} - <strong>Enviado por:</strong> ${tramite.usuario}`;
                        tramiteList.appendChild(listItem);
                    });
                } else {
                    accessDeniedDiv.style.display = 'block';
                    setTimeout(() => {
                        window.location.href = '../';
                    }, 3000);
                }
            } else {
                accessDeniedDiv.style.display = 'block';
                setTimeout(() => {
                    window.location.href = '../';
                }, 3000);
            }
        });
    </script>
</body>
</html>
